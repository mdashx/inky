- hosts: inky
  remote_user: vagrant
  become: yes
  become_user: root
  tasks:
    - name: apt proxy hostname
      lineinfile: dest=/etc/hosts line="192.168.33.66 apt.mdashx.com"
    - name: Use apt proxy
      copy: src=./02proxy dest=/etc/apt/apt.conf.d/02proxy
    - name: Install Aptitude because Ansible thinks it should be there
      command: apt -y install aptitude

    # - name: apt-get update to fix grub bug
    #   command: apt-get update

    # https://github.com/mitchellh/vagrant/issues/289
    # - name: fix Grub bug
    # sudo apt-get -y remove grub-pc
    # sudo DEBIAN_FRONTEND=noninteractive aptitude install -y -q grub-pc
    # - name: fix grub bug (uninstall)
    #   command: apt-get -y remove grub-pc
    #
    # - name: fix grub bug (install)
    #   command: DEBIAN_FRONTEND=noninteractive aptitude install -y -q grub-pc


    # - name: add main packages (git, pip, nginx, emacs, etc.)
    #   apt:  name={{ item }} state=latest force=yes
    #   with_items:
    #     - git
    #     - python-pip
        # - nginx
        # - python-dev
        # - libpq-dev
        # - postgresql-client-common
        # - postgresql-client
        # - emacs-snapshot
    # - name: Install virtualenv
    #   pip:  name=virtualenv
    # - name: Install virtualenvwrapper
    #   pip:  name=virtualenvwrapper
    # The username should definitely be a variable
    # - name: create user 'tom'
    #   user: name=tom generate_ssh_key=yes
    # - name: install .bashrc
    #   become: yes
    #   become_user: tom
    #   copy: src=./bashrc.sh dest=/home/tom/.bashrc
    # - name: symbolic links to synced directories
    #   file: src=/synced dest=/home/tom/work state=link
    #   become: yes
    #   become_user: tom
    # - name: install Emacs config
    #   git:  repo=https://github.com/mdashx/myemacs.git dest=/home/tom/.emacs.d/
    #   become: yes
    #   become_user: tom
    # - name: create bin dir
    #   file: path=/home/tom/bin state=directory
    #   become: yes
    #   become_user: tom
    # - name: get mybin
    #   git:  repo=https://github.com/mdashx/mybin.git dest=/home/tom/mybin
    #   become: yes
    #   become_user: tom
    # - name: install mybin
    #   shell: cd /home/tom/mybin && bash /home/tom/mybin/install.sh
    #   become: yes
    #   become_user: tom
    # - name: rm mybin dir
    #   file: path=/home/tom/mybin state=absent
    #   become: yes
    #   become_user: tom
    # - name: install gitconfig
    #   copy: src=./gitconfig dest=/home/tom/.gitconfig


    # I should install my .bashrc, pull in Emacs config, install my
    # $HOME/bin, etc.  Setup Git username, etc.  Would be nice to set
    # the target machines environment variabels for Github username,
    # etc. and run the addkeys script

    # gitconfig should use a template with vars

    # Need to add Docker

    # Install Ansible

    # Not doing this anymore, but keeping for now for reference:
    # Copying SSH key so I can run Ansible from command line in addition to running from Vagrant
    #  - name: copy SSH pubkey to 'vagrant' authorized keys
    #  copy: src=/{{ lookup('env', 'HOME') }}/.ssh/id_rsa.pub dest=/home/vagrant/.ssh/authorized_keys2 owner=vagrant group=vagrant mode=0644


    # Add Tom to sudoers group and vagrant group and docker group
